/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */
apply plugin: 'war'

dependencies {
compile 'log4j:log4j:1.2.17'
compile 'commons-io:commons-io:2.6'
}

repositories {
mavenCentral()
}

war {
archiveName 'app.war'
}

def verF = './build/resources/main/greeting.txt'
def propF = './gradle.properties'

task updateVer {
    doLast {
	def prop = new File(propF)
	def newVer = version[0..3]+(Integer.parseInt(version.substring(4))+1)
	prop.write('version='+ newVer)
	println('Successfuly updated gradle.properties from version '+version+' to '+ newVer)
    }
}
task toBuild {
    doLast {
	def gr = new File(verF)
        gr.write(version)
        println('Building version: '+version)
    }
    
}
war.dependsOn toBuild
toBuild.mustRunAfter processResources